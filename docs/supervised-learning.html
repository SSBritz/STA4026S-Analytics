<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Supervised Learning |  STA4026S – Honours Analytics Section B: Theory and Application of Supervised Learning</title>
  <meta name="description" content="<br />
STA4026S – Honours Analytics<br />
Section B: Theory and Application of Supervised Learning</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Supervised Learning |  STA4026S – Honours Analytics Section B: Theory and Application of Supervised Learning" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Supervised Learning |  STA4026S – Honours Analytics Section B: Theory and Application of Supervised Learning" />
  
  
  

<meta name="author" content="Stefan S. Britz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="model-selection-regularisation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Supervised Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>2</b> Supervised Learning</a>
<ul>
<li class="chapter" data-level="2.1" data-path="supervised-learning.html"><a href="supervised-learning.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>2.1</b> Bias-Variance trade-off</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="supervised-learning.html"><a href="supervised-learning.html#example-1-simulation-1"><i class="fa fa-check"></i><b>2.1.1</b> Example 1 – Simulation 1</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="supervised-learning.html"><a href="supervised-learning.html#model-validation"><i class="fa fa-check"></i><b>2.2</b> Model validation</a></li>
<li class="chapter" data-level="2.3" data-path="supervised-learning.html"><a href="supervised-learning.html#side-note-statistical-learning-vs-machine-learning"><i class="fa fa-check"></i><b>2.3</b> Side note: Statistical learning vs machine learning</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="model-selection-regularisation.html"><a href="model-selection-regularisation.html"><i class="fa fa-check"></i><b>3</b> Model Selection &amp; Regularisation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="model-selection-regularisation.html"><a href="model-selection-regularisation.html#l1-and-l2"><i class="fa fa-check"></i><b>3.1</b> L1 and L2</a></li>
<li class="chapter" data-level="3.2" data-path="model-selection-regularisation.html"><a href="model-selection-regularisation.html#elasticnet"><i class="fa fa-check"></i><b>3.2</b> ElasticNet</a></li>
<li class="chapter" data-level="3.3" data-path="model-selection-regularisation.html"><a href="model-selection-regularisation.html#pcr-pls"><i class="fa fa-check"></i><b>3.3</b> PCR &amp; PLS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="classification-models.html"><a href="classification-models.html"><i class="fa fa-check"></i><b>4</b> Classification Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="classification-models.html"><a href="classification-models.html#logistic-regression"><i class="fa fa-check"></i><b>4.1</b> Logistic regression</a></li>
<li class="chapter" data-level="4.2" data-path="classification-models.html"><a href="classification-models.html#model-evaluation"><i class="fa fa-check"></i><b>4.2</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="classification-models.html"><a href="classification-models.html#roc-curves"><i class="fa fa-check"></i><b>4.2.1</b> ROC Curves</a></li>
<li class="chapter" data-level="4.2.2" data-path="classification-models.html"><a href="classification-models.html#pr-curves"><i class="fa fa-check"></i><b>4.2.2</b> PR curves</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="beyond-linearity.html"><a href="beyond-linearity.html"><i class="fa fa-check"></i><b>5</b> Beyond Linearity</a>
<ul>
<li class="chapter" data-level="5.1" data-path="beyond-linearity.html"><a href="beyond-linearity.html#gams"><i class="fa fa-check"></i><b>5.1</b> GAMs</a></li>
<li class="chapter" data-level="5.2" data-path="beyond-linearity.html"><a href="beyond-linearity.html#wls---loesslowess"><i class="fa fa-check"></i><b>5.2</b> WLS - LOESS/LOWESS???</a></li>
<li class="chapter" data-level="5.3" data-path="beyond-linearity.html"><a href="beyond-linearity.html#knn"><i class="fa fa-check"></i><b>5.3</b> KNN</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tree-based-methods.html"><a href="tree-based-methods.html"><i class="fa fa-check"></i><b>6</b> Tree-based Methods</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tree-based-methods.html"><a href="tree-based-methods.html#cart"><i class="fa fa-check"></i><b>6.1</b> CART</a></li>
<li class="chapter" data-level="6.2" data-path="tree-based-methods.html"><a href="tree-based-methods.html#bagging-rf"><i class="fa fa-check"></i><b>6.2</b> Bagging &amp; RF</a></li>
<li class="chapter" data-level="6.3" data-path="tree-based-methods.html"><a href="tree-based-methods.html#boosting"><i class="fa fa-check"></i><b>6.3</b> Boosting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p><img src="figs/Dept_Logo.jpg" style="width:50.0%" /><img src="figs/UCTLogo.jpg" style="width:20.0%" /><br />
STA4026S – Honours Analytics<br />
Section B: Theory and Application of Supervised Learning</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="supervised-learning" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Supervised Learning<a href="supervised-learning.html#supervised-learning" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter aims to briefly summarise the key aspects of supervised learning that will be relevant for the following sections, most of which you should be familiar with already. Whereas there are many good sources that provide a more comprehensive discussion, Chapter 2 of <span class="citation">James et al. (2013)</span> is sufficient for the level and scope of this course.</p>
<p>Using a set of observations to uncover some underlying process in the real world is the basic premise of “learning from data” <span class="citation">(Abu-Mostafa et al., 2012, p. 11)</span>. By discerning patterns, relationships, and trends within the data, machines become capable of making informed decisions and predictions in various domains. Different learning paradigms have developed to address different problems and data structures, and are generally divided into three broad classes: supervised learning, unsupervised learning, and reinforcement learning. We will not discuss the latter in this course.</p>
<p>The basic distinction is that <strong>supervised learning</strong> refers to cases where there is some <strong>target variable</strong>, usually indicated as <span class="math inline">\(Y\)</span>, whereas if we are interested in the structures and patterns in explanatory variables<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> only, we refer to unsupervised learning.</p>
<p>Given a quantitative response <span class="math inline">\(Y\)</span> and a set of <span class="math inline">\(p\)</span> predictors <span class="math inline">\(X_1, X_2, \ldots, X_p\)</span>, we are interested in the assumed, unobserved function that maps the inputs to the outputs:</p>
<p><span class="math display">\[Y = \underbrace{f(X)}_{systematic} + \underbrace{\epsilon}_{random},\]</span></p>
<p>where <span class="math inline">\(f(.)\)</span> represents the fixed, but unknown function and <span class="math inline">\(\epsilon\)</span> is a random error term, independent of <span class="math inline">\(X\)</span>, with <span class="math inline">\(E(X) = 0\)</span>. By estimating <span class="math inline">\(f\)</span> such that</p>
<p><span class="math display">\[\hat{Y} = \hat{f}(X),\]</span></p>
<p>we allow for both prediction of <span class="math inline">\(Y\)</span> – which is the primary goal in forecasting – and inference, i.e. describing how <span class="math inline">\(Y\)</span> is affected by changes in <span class="math inline">\(X\)</span>.</p>
<p>Hypothesising <span class="math inline">\(\hat{f}\)</span> can be done in two ways, namely via a parametric or a non-parametric approach.</p>
<p><strong>Parametric approach</strong></p>
<p>Here an assumption is made about the the functional form of <span class="math inline">\(f\)</span>, for example</p>
<p><span class="math display">\[f(\boldsymbol{X}) = \beta_0 + \sum_{j=1}^p\beta_jX_j.\]</span></p>
<p>The best estimate of <span class="math inline">\(f\)</span> is now defined as the set of parameters <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> that minimise some specified loss function. Given a set of observations <span class="math inline">\(\mathcal{D}=\{\boldsymbol{x}_i, y_i\}_{i=1}^n\)</span> – henceforth referred to as the <strong>training set</strong> – we could use ordinary least squares to minimise the mean squared error (MSE):</p>
<p><span class="math display">\[MSE = \frac{1}{n}\sum_{i=1}^n\left[y_i - \hat{f}(x_i)\right]^2 \]</span> Therefore, the problem of estimating an arbitrary p-dimensional function is simplified to fitting a set of parameters.</p>
<p><strong>Non-parametric approach</strong></p>
<p>Another option is to make no explicit assumptions regarding the functional form of <span class="math inline">\(f\)</span>. This allows one to fit a wide range of possible forms for <span class="math inline">\(f\)</span> – in these notes we consider K-nearest neighbours and tree-based methods – but since estimation is not reduced to estimating a set of parameters, this approach generally requires more data than parametric estimation.</p>
<p>The objective remains to find <span class="math inline">\(f\)</span> that fits the available data as closely as possible, whilst avoiding overfitting to ensure that the model generalises well to unseen data.</p>
<p><strong>Generalisation</strong></p>
<p>The primary goal of prediction is of course to accurately predict the outcomes of observations not yet observed by the model, referred to as out-of-sample observations.</p>
<p>Consider the case where the estimated function <span class="math inline">\(\hat{f}\)</span> is fixed and out-of-sample observations of the variables are introduced, which we will denote as <span class="math inline">\(\{\boldsymbol{x}_0, y_0\}\)</span>. The expected MSE for these <strong>test set</strong> observations (see Section <a href="supervised-learning.html#model-validation">2.2</a>) can be deconstructed as follows:</p>
<span class="math display" id="eq:test-mse-decomp">\[\begin{align}
E\left[y_0 - \hat{f}(\boldsymbol{x}_0) \right]^2 &amp;= E\left[f(\boldsymbol{x}_0) + \epsilon - \hat{f}(\boldsymbol{x}_0)\right]^2 \\
&amp;= E\left[\left(f(\boldsymbol{x}_0) - \hat{f}(\boldsymbol{x}_0)\right)^2 + 2\epsilon \left(f(\boldsymbol{x}_0) - \hat{f}(\boldsymbol{x}_0) \right) + \epsilon^2\right] \\
&amp;= E\left[f(\boldsymbol{x}_0) - \hat{f}(\boldsymbol{x}_0)\right]^2 + 2E[\epsilon]E\left[f(\boldsymbol{x}_0) - \hat{f}(\boldsymbol{x}_0)\right] + E\left[\epsilon^2\right] \\
&amp;= \underbrace{E\left[f(\boldsymbol{x}_0) - \hat{f}(\boldsymbol{x}_0)\right]^2}_{reducible} + \underbrace{Var(\epsilon)}_{irreducible} \tag{2.1}
\end{align}\]</span>
<p>The primary goal of machine learning is to find an <span class="math inline">\(\hat{f}\)</span> that best approximates the underlying, unknown relationship between the input and output variables by minimising the reducible error. Note that because of the irreducible component (the “noise” in the data), there will always be some lower bound for the theoretical MSE, and that <strong>this bound is almost always unknown in practice</strong> <span class="citation">(James et al., 2013, p. 19)</span>.</p>
<p>By now you will be familiar with the concept of bias-variance trade-off, according to which we attempt to find a sufficiently (but not overly) complex model. The reducible error component can be decomposed further to help illustrate this trade-off.</p>
<div id="bias-variance-trade-off" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Bias-Variance trade-off<a href="supervised-learning.html#bias-variance-trade-off" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider again a fixed <span class="math inline">\(\hat{f}\)</span> and out-of-sample observations <span class="math inline">\(\{\boldsymbol{x}_0, y_0\}\)</span>. For ease of notation, let <span class="math inline">\(f = f(\boldsymbol{x}_0)\)</span> and <span class="math inline">\(\hat{f} = \hat{f}(\boldsymbol{x}_0)\)</span>. Also note that <span class="math inline">\(f\)</span> is deterministic such that <span class="math inline">\(E\left[f\right] = f\)</span>.</p>
<p>Starting with the reducible error in Equation <a href="supervised-learning.html#eq:test-mse-decomp">(2.1)</a>, we have</p>
<span class="math display" id="eq:bias-var">\[\begin{align}
E\left[f - \hat{f} \right]^2 &amp;= E\left[\hat{f} - f \right]^2 \\
&amp;= E\left[\hat{f} - E(\hat{f}) + E(\hat{f}) - f \right]^2 \\
&amp;= E\left\{ \left[\hat{f} - E(\hat{f})\right]^2 + 2\left[\hat{f} - E(\hat{f})\right] \left[E(\hat{f}) - f\right] + \left[E(\hat{f}) - f\right]^2 \right\} \\
&amp;= E\left[\hat{f} - E(\hat{f})\right]^2 + 2E\left\{\left[\hat{f} - E(\hat{f})\right] \left[E(\hat{f}) - f\right]\right\} + E\left[E(\hat{f}) - f\right]^2 \\
&amp;= Var\left[\hat{f}\right] + 0 + \left[E(\hat{f}) - f\right]^2 \\
&amp;= Var\left[\hat{f}\right] + Bias^2\left[\hat{f}\right] \tag{2.2}
\end{align}\]</span>
<p>Showing that the crossproduct term equals zero:</p>
<span class="math display">\[\begin{align}
E\left\{\left[\hat{f} - E(\hat{f})\right] \left[E(\hat{f}) - f\right]\right\} &amp;= E\left[\hat{f}E(\hat{f}) - E(\hat{f})E(\hat{f}) - \hat{f}f + E(\hat{f})f\right] \\
&amp;= E(\hat{f})E(\hat{f}) - E(\hat{f})E(\hat{f}) - E(\hat{f})f + E(\hat{f})f \\
&amp;= 0
\end{align}\]</span>
<p>Therefore, in order to minimise the expected test MSE we need to find a model that has the lowest combined variance and (squared) bias.</p>
<p>The <strong>variance</strong> represents the extent to which <span class="math inline">\(\hat{f}\)</span> changes between different training samples taken from the same population. The bias of <span class="math inline">\(\hat{f}\)</span> is simply the error that is introduced by approximating the real-world relationship with a simpler representation. Note, however, that since <span class="math inline">\(f\)</span> is generally unknown, the bias component cannot be directly observed or measured outside of simulations. However, these simulations may help us illustrate how the bias and variance change as model complexity increases.</p>
<p>Although the concepts of model complexity and flexibility are not necessarily perfectly defined – depending on the class of model being hypothesised – the following example should provide an intuitive understanding.</p>
<div id="example-1-simulation-1" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Example 1 – Simulation 1<a href="supervised-learning.html#example-1-simulation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To allow for easy visualisation, let us consider a simple model with only one feature:</p>
<p><span class="math display">\[Y = X + 2\cos(5X) + \epsilon,\]</span>
where <span class="math inline">\(\epsilon \sim N(0, 2)\)</span>.</p>
<p>Below we simulate <span class="math inline">\(n = 100\)</span> observations from <span class="math inline">\(X \sim U(-2,2)\)</span>, to which we fit cubic smoothing splines of increasing complexity. [Splines are beyond the scope of this course, but provide an easy-to-see illustration of “flexibility”]</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="supervised-learning.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4026</span>)</span>
<span id="cb1-2"><a href="supervised-learning.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="supervised-learning.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulated data</span></span>
<span id="cb1-4"><a href="supervised-learning.html#cb1-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb1-5"><a href="supervised-learning.html#cb1-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">cos</span>(<span class="dv">5</span><span class="sc">*</span>x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb1-6"><a href="supervised-learning.html#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="supervised-learning.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#The true function</span></span>
<span id="cb1-8"><a href="supervised-learning.html#cb1-8" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb1-9"><a href="supervised-learning.html#cb1-9" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> xx <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">cos</span>(<span class="dv">5</span><span class="sc">*</span>xx)</span>
<span id="cb1-10"><a href="supervised-learning.html#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="supervised-learning.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit cubic splines with increasing degrees of freedom</span></span>
<span id="cb1-12"><a href="supervised-learning.html#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(dof <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">50</span>){</span>
<span id="cb1-13"><a href="supervised-learning.html#cb1-13" aria-hidden="true" tabindex="-1"></a>  fhat <span class="ot">&lt;-</span> <span class="fu">smooth.spline</span>(x, y, <span class="at">df =</span> dof)</span>
<span id="cb1-14"><a href="supervised-learning.html#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(x, y, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb1-15"><a href="supervised-learning.html#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(xx, f, <span class="st">&#39;l&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-16"><a href="supervised-learning.html#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(fhat, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-17"><a href="supervised-learning.html#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;Degrees of freedom:&#39;</span>, dof))</span>
<span id="cb1-18"><a href="supervised-learning.html#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>, <span class="fu">c</span>(<span class="st">&#39;f(x) - True&#39;</span>, <span class="fu">expression</span>(<span class="fu">hat</span>(f)(x) <span class="sc">~</span> <span class="st">&#39;- Cubic spline&#39;</span>)), </span>
<span id="cb1-19"><a href="supervised-learning.html#cb1-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-20"><a href="supervised-learning.html#cb1-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figs/unnamed-chunk-144-.gif" width="672" /></p>
<p>This serves to illustrate how the model’s degrees of freedom is directly proportional to the model’s complexity. However, to extricate the bias and variance components, we need to observe these models’ fit on out-of-sample data across many random realisations of training samples.</p>
<p>In the following simulation we again observe <span class="math inline">\(n=100\)</span> training observations at a time, to which the same models of varying complexity as above are fitted. Each model’s fit is then assessed on a fixed set of <span class="math inline">\(100\)</span> testing observations. This process is repeated <span class="math inline">\(250\)</span> times, such that we can keep track of how each test observation’s predictions vary across the iterations, as well as the errors.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="supervised-learning.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="supervised-learning.html#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="supervised-learning.html#cb2-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>        <span class="co">#Sample size</span></span>
<span id="cb2-4"><a href="supervised-learning.html#cb2-4" aria-hidden="true" tabindex="-1"></a>num_sims <span class="ot">&lt;-</span> <span class="dv">1000</span><span class="co">#Number of iterations</span></span>
<span id="cb2-5"><a href="supervised-learning.html#cb2-5" aria-hidden="true" tabindex="-1"></a>dofs <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">24</span>    <span class="co">#Model complexities</span></span>
<span id="cb2-6"><a href="supervised-learning.html#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="supervised-learning.html#cb2-7" aria-hidden="true" tabindex="-1"></a>pred_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> num_sims, <span class="at">ncol =</span> n) <span class="co">#To store each set of predictions</span></span>
<span id="cb2-8"><a href="supervised-learning.html#cb2-8" aria-hidden="true" tabindex="-1"></a>mses <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> num_sims)     <span class="co">#Also want to track the testing MSEs</span></span>
<span id="cb2-9"><a href="supervised-learning.html#cb2-9" aria-hidden="true" tabindex="-1"></a>red_err <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> num_sims)  <span class="co">#As well as the reducible error</span></span>
<span id="cb2-10"><a href="supervised-learning.html#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="supervised-learning.html#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Herein we will capture the deconstructed components for each model</span></span>
<span id="cb2-12"><a href="supervised-learning.html#cb2-12" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Var =</span> <span class="cn">NA</span>, <span class="at">Bias2 =</span> <span class="cn">NA</span>, <span class="at">Red_err =</span> <span class="cn">NA</span>, <span class="at">MSE =</span> <span class="cn">NA</span>)</span>
<span id="cb2-13"><a href="supervised-learning.html#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="supervised-learning.html#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Testing data</span></span>
<span id="cb2-15"><a href="supervised-learning.html#cb2-15" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb2-16"><a href="supervised-learning.html#cb2-16" aria-hidden="true" tabindex="-1"></a>f_test <span class="ot">&lt;-</span> x_test <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">cos</span>(<span class="dv">5</span><span class="sc">*</span>x_test) <span class="co">#This is the part we don&#39;t know outside sims!!</span></span>
<span id="cb2-17"><a href="supervised-learning.html#cb2-17" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> f_test <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb2-18"><a href="supervised-learning.html#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="supervised-learning.html#cb2-19" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#To keep track of dof iterations, whilst easily changing the range above</span></span>
<span id="cb2-20"><a href="supervised-learning.html#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="supervised-learning.html#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(dof <span class="cf">in</span> dofs) { <span class="co">#Repeat over all model complexities</span></span>
<span id="cb2-22"><a href="supervised-learning.html#cb2-22" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> d<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb2-23"><a href="supervised-learning.html#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_sims){ </span>
<span id="cb2-24"><a href="supervised-learning.html#cb2-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-25"><a href="supervised-learning.html#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Training data</span></span>
<span id="cb2-26"><a href="supervised-learning.html#cb2-26" aria-hidden="true" tabindex="-1"></a>    x_train <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb2-27"><a href="supervised-learning.html#cb2-27" aria-hidden="true" tabindex="-1"></a>    y_train <span class="ot">&lt;-</span> x_train <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">cos</span>(<span class="dv">5</span><span class="sc">*</span>x_train) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb2-28"><a href="supervised-learning.html#cb2-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-29"><a href="supervised-learning.html#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Fit cubic spline</span></span>
<span id="cb2-30"><a href="supervised-learning.html#cb2-30" aria-hidden="true" tabindex="-1"></a>    spline_mod <span class="ot">&lt;-</span> <span class="fu">smooth.spline</span>(x_train, y_train, <span class="at">df =</span> dof)</span>
<span id="cb2-31"><a href="supervised-learning.html#cb2-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-32"><a href="supervised-learning.html#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Predict on OOS data</span></span>
<span id="cb2-33"><a href="supervised-learning.html#cb2-33" aria-hidden="true" tabindex="-1"></a>    yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(spline_mod, x_test)<span class="sc">$</span>y</span>
<span id="cb2-34"><a href="supervised-learning.html#cb2-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-35"><a href="supervised-learning.html#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">#And store</span></span>
<span id="cb2-36"><a href="supervised-learning.html#cb2-36" aria-hidden="true" tabindex="-1"></a>    pred_mat[iter, ] <span class="ot">&lt;-</span> yhat</span>
<span id="cb2-37"><a href="supervised-learning.html#cb2-37" aria-hidden="true" tabindex="-1"></a>    red_err[iter] <span class="ot">&lt;-</span> <span class="fu">mean</span>((f_test <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-38"><a href="supervised-learning.html#cb2-38" aria-hidden="true" tabindex="-1"></a>    mses[iter] <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_test <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-39"><a href="supervised-learning.html#cb2-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-40"><a href="supervised-learning.html#cb2-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-41"><a href="supervised-learning.html#cb2-41" aria-hidden="true" tabindex="-1"></a>  var_fhat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(pred_mat, <span class="dv">2</span>, var)) <span class="co">#E[\hat{f} - E(\hat{f})]^2</span></span>
<span id="cb2-42"><a href="supervised-learning.html#cb2-42" aria-hidden="true" tabindex="-1"></a>  bias2_fhat <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">colMeans</span>(pred_mat) <span class="sc">-</span> f_test)<span class="sc">^</span><span class="dv">2</span>) <span class="co">#[E(\hat{f}) - f]^2</span></span>
<span id="cb2-43"><a href="supervised-learning.html#cb2-43" aria-hidden="true" tabindex="-1"></a>  reducible <span class="ot">&lt;-</span> <span class="fu">mean</span>(red_err) <span class="co">#E[f - \hat{f}]^2</span></span>
<span id="cb2-44"><a href="supervised-learning.html#cb2-44" aria-hidden="true" tabindex="-1"></a>  MSE <span class="ot">&lt;-</span> <span class="fu">mean</span>(mses)          <span class="co">#E[y_0 - \hat{f}]^2</span></span>
<span id="cb2-45"><a href="supervised-learning.html#cb2-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-46"><a href="supervised-learning.html#cb2-46" aria-hidden="true" tabindex="-1"></a>  results[d, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(var_fhat, bias2_fhat, reducible, MSE)</span>
<span id="cb2-47"><a href="supervised-learning.html#cb2-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-48"><a href="supervised-learning.html#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="supervised-learning.html#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the results</span></span>
<span id="cb2-50"><a href="supervised-learning.html#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="supervised-learning.html#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dofs, results<span class="sc">$</span>Var, <span class="st">&#39;l&#39;</span>, <span class="at">col =</span> <span class="st">&#39;orange&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb2-52"><a href="supervised-learning.html#cb2-52" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Model complexity&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(results[,<span class="sc">-</span><span class="dv">4</span>])))</span>
<span id="cb2-53"><a href="supervised-learning.html#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(dofs, results<span class="sc">$</span>Bias2, <span class="st">&#39;l&#39;</span>, <span class="at">col =</span> <span class="st">&#39;lightblue&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb2-54"><a href="supervised-learning.html#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(dofs, results<span class="sc">$</span>Red_err, <span class="st">&#39;l&#39;</span>, <span class="at">col =</span> <span class="st">&#39;darkred&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb2-55"><a href="supervised-learning.html#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> dofs[<span class="fu">which.min</span>(results<span class="sc">$</span>Red_err)], <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="figs/unnamed-chunk-145-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="supervised-learning.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lines(dofs, results[, 4], &#39;l&#39;, lwd = 2)</span></span></code></pre></div>
</div>
</div>
<div id="model-validation" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Model validation<a href="supervised-learning.html#model-validation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hoef nie CV van scratch af nie, Et het die beginsel gedek.</p>
<p>This has been a very brief summary of some of the basic statistical learning principles we will encounter going forward. For a more in-depth discussion,</p>
</div>
<div id="side-note-statistical-learning-vs-machine-learning" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Side note: Statistical learning vs machine learning<a href="supervised-learning.html#side-note-statistical-learning-vs-machine-learning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Statistical Learning:</p>
<p>Foundation: Statistical learning is rooted in the field of statistics and builds upon principles of probability, inference, and hypothesis testing. Objective: The primary objective of statistical learning is to understand and model relationships between variables in order to make predictions or draw insights from data. Emphasis: Statistical learning places a strong emphasis on understanding the underlying data-generating process and making inferences about population characteristics based on sample data. Assumptions: It often involves making explicit assumptions about the underlying statistical distributions and relationships between variables. Interpretability: Statistical models tend to be more interpretable, as they often involve understanding the impact and significance of individual variables on the outcome.</p>
<p>Foundation: Machine learning draws from various fields, including computer science, artificial intelligence, and statistical learning, but with a stronger emphasis on algorithmic and computational aspects. Objective: The primary objective of machine learning is to develop algorithms that can automatically learn patterns and relationships from data, with an emphasis on predictive accuracy and generalization to new, unseen data. Emphasis: While understanding the underlying data-generating process is important, machine learning is often more focused on achieving optimal predictive performance. Assumptions: Machine learning methods often work in a more agnostic manner and may not rely heavily on explicit statistical assumptions. Interpretability: Some machine learning models, like deep neural networks, can be highly complex and challenging to interpret due to their architecture and the multitude of learned features.</p>
<p>It’s important to note that the distinction between statistical learning and machine learning can sometimes be blurred, and the two fields have evolved to influence each other over time. Many modern machine learning techniques, such as ensemble methods and regularization, have strong roots in statistical learning theory. Additionally, both fields share common goals of extracting insights from data and making predictions, but they may approach these goals with different philosophical and methodological perspectives.</p>
<p>In essence, statistical learning often focuses on understanding the probabilistic relationships between variables, while machine learning places greater emphasis on developing algorithms that can learn patterns directly from data, sometimes sacrificing interpretability for predictive performance.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Often referred to as <strong>features</strong> in the learning context, or <strong>predictors</strong> in supervised learning specifically.<a href="supervised-learning.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-selection-regularisation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/SSBritz/STA4026S-Analytics-SecB/edit/main/02-SL.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/SSBritz/STA4026S-Analytics-SecB/blob/main/02-SL.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
